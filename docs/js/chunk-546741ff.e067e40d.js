(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-546741ff"],{"965f":function(t,e,o){"use strict";var s=o("bf03"),n=o.n(s);n.a},"96f2":function(t,e,o){"use strict";o.d(e,"g",(function(){return n})),o.d(e,"b",(function(){return i})),o.d(e,"d",(function(){return c})),o.d(e,"e",(function(){return r})),o.d(e,"c",(function(){return a})),o.d(e,"f",(function(){return u})),o.d(e,"a",(function(){return l}));var s=o("1bab");function n(){return Object(s["a"])({method:"get",url:"/rooms"})}function i(t,e){return Object(s["a"])({method:"post",url:"/".concat(t),data:e})}function c(t){return Object(s["a"])({method:"get",url:"/enterpublic",params:{roomId:t}})}function r(t,e){return Object(s["a"])({method:"post",url:"/enterprivate",data:{roomId:t,password:e}})}function a(t){return Object(s["a"])({method:"get",url:"/deleteRoom",params:{roomId:t}})}function u(){return Object(s["a"])({method:"get",url:"/editor",params:{userId:sessionStorage.getItem("userId")}})}function l(t){return Object(s["a"])({method:"post",url:"/editing",data:t})}},b737:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"watch_page"},[o("video-player",{ref:"videoPlayer",staticClass:"video-player vjs-custom-skin",attrs:{id:"vedio",playsinline:!0,options:t.playerOptions}}),o("div",{staticClass:"operate"},[o("span",{staticClass:"operate_box",on:{click:t.goHome}},[t._v("退出房间")]),o("span",{staticClass:"operate_box",on:{click:function(e){return t.delRoom(t.room.roomId)}}},[t._v("解散房间")])]),o("div",{attrs:{id:"welcome"}},[t._v("来和大家聊聊~")]),o("div",{staticClass:"chat_box"},[o("div",{staticClass:"chat_msg"},t._l(t.chat_msg,(function(e,s){return o("div",{key:s,staticClass:"item.text"},[o("div",{staticClass:"item_name"},[t._v(t._s(e.name))]),o("div",{staticClass:"item_text"},[t._v(t._s(e.text))])])})),0),o("div",{staticClass:"chat_my"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.my_ipt,expression:"my_ipt"}],staticClass:"my_text",attrs:{type:"text"},domProps:{value:t.my_ipt},on:{input:function(e){e.target.composing||(t.my_ipt=e.target.value)}}}),o("input",{staticClass:"my_sub",attrs:{type:"submit",value:"发送"},on:{click:t.subMsg}})])])],1)},n=[],i=o("96f2"),c={data:function(){return{isConnect:!1,room:{},my_ipt:"",chat_msg:[],playerOptions:{autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"4:3",fluid:!0,sources:[{type:"rtmp/flv",src:""}],techOrder:["flash"],live:!0,width:document.documentElement.clientWidth,notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}}}},mounted:function(){this.room=this.$route.params.room,this.playerOptions.sources[0].src=this.room.movie.src,console.log(this.playerOptions.sources[0].src),this.initWebsocket()},methods:{delRoom:function(t){var e=this;Object(i["c"])(t).then((function(t){if(!t.data.success)return alert(t.data.Msg);e.websocket.send(JSON.stringify({msg:"房间已被".concat(sessionStorage.getItem("userName"),"解散，即将返回首页!")}))}))},goHome:function(){this.isConnect=!1,this.websocket.close(),this.$router.push("/user")},subMsg:function(){sessionStorage.getItem("userName")?this.my_ipt?(this.websocket.send(JSON.stringify({text:this.my_ipt,name:sessionStorage.getItem("userName")})),this.my_ipt=""):this.$alert("发送内容不能为空！","提示",{confirmButtonText:"确定",callback:function(t){}}):this.$alert("请先登录","提示",{confirmButtonText:"确定",callback:function(t){}})},initWebsocket:function(){var t=this,e="wss://47.97.214.211/chat/".concat(this.room.roomId);"WebSocket"in window&&!this.isConnect?(this.websocket=new WebSocket(e),this.isConnect=!0):alert(" Not support websocket"),this.websocket.onmessage=function(e){var o=JSON.parse(e.data);if(!o.msg)return t.chat_msg.push(o);t.$alert("此房间已经被 ".concat(o.msg," 解散，即将返回首页"),"提示",{confirmButtonText:"确定",callback:function(e){t.isConnect=!1,t.websocket.close(),t.$router.push("/user")}})},this.websocket.onclose=function(){console.log("WebSocket连接关闭")},this.websocket.onerror=function(){this.connect&&(this.websocket=new WebSocket(e))},window.onbeforeunload=function(){this.websocket.close()},this.$router.beforeEach((function(e,o,s){t.websocket.close(),s()}))}}},r=c,a=(o("965f"),o("2877")),u=Object(a["a"])(r,s,n,!1,null,"3acb4c31",null);e["default"]=u.exports},bf03:function(t,e,o){}}]);
//# sourceMappingURL=chunk-546741ff.e067e40d.js.map